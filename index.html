<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Title of the document</title>
<link rel="stylesheet" type="text/css" href="css/main.css">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, shrink-to-fit=no">
</head>

<body>
<div id="cover">
<div id="particles-js"></div>
<!-- stats - count particles -->
<div class="count-particles">
  <span class="js-count-particles">--</span> particles
</div>

<div class="circle">
<div class="header-text">TAP AWAY THE HEARTS</div>
</div>
</div>
<div id="page">
  <img src="mobile_03.jpg"/>
</div>
</body>

<script src="scripts/particles.js"></script>
<script src="https://threejs.org/examples/js/libs/stats.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js"></script>

<script>
  var options = 'scripts/options.jason',
  hearts = ['hearts/heart-grey.png','hearts/heart-grey2.png','hearts/heart-grey3.png','hearts/heart-grey-reverse.png','hearts/heart-grey2-reverse.png','hearts/heart-grey3-reverse.png','hearts/heart-pink.png','hearts/heart-pink2.png','hearts/heart-pink3.png','hearts/heart-pink-reverse.png','hearts/heart-pink2-reverse.png','hearts/heart-pink3-reverse.png','hearts/heart-yelow.png','hearts/heart-yelow2.png','hearts/heart-yelow3.png','hearts/heart-yelow-reverse.png','hearts/heart-yelow2-reverse.png','hearts/heart-yelow3-reverse.png'];
        particlesJS('particles-js', {
        "particles": {
    "number": {
      "value": 100,
      "density": {
        "enable": true,
        "value_area": 200
      }
    },
    "color": {
      "value": "#ffffff"
    },
    "shape": {
      "type": "image",
      "stroke": {
        "width": 0,
        "color": "#000000"
      },
      "polygon": {
        "nb_sides": 5
      },
      "image": {           
        "src": "hearts/transparent1x1.png",
        "width": 65,
        "height": 65
      }
    },
    "opacity": {
      "value": 1,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 1,
        "opacity_min": 0.1,
        "sync": false
      }
    },
    "size": {
      "value": 15,
      "random": false,
      "anim": {
        "enable": false,
        "speed": 10,
        "size_min": 10,
        "sync": false
      }
    },
    "line_linked": {
      "enable": false,
      "distance": 150,
      "color": "#ffffff",
      "opacity": 0.4,
      "width": 1
    },
    "move": {
      "enable": true,
      "speed": 1,
      "direction": "none",
      "random": true,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": {
        "enable": false,
        "rotateX": 600,
        "rotateY": 1200
      }
    }
  },
  "interactivity": {
    "detect_on": "canvas",
    "events": {
      "onhover": {
        "enable": true,
        "mode": "repulse"
      },
      "onclick": {
        "enable": false,
        "mode": "repulse"
      },
      "resize": true
    },
    "modes": {
      "grab": {
        "distance": 400,
        "line_linked": {
          "opacity": 1
        }
      },
      "bubble": {
        "distance": 400,
        "size": 40,
        "duration": 2,
        "opacity": 8,
        "speed": 3
      },
      "repulse": {
        "distance": 150,
        "duration": 0.4
      },
      "push": {
        "particles_nb": 4
      },
      "remove": {
        "particles_nb": 2
      }
    }
  },
  "retina_detect": true
});
        var pJS = window.pJSDom[0].pJS,
          particles = pJS.particles.array;
        setTimeout(() => {
          particles.forEach(particle => this.customizeParticle(particle))
        }, 100);

       var customizeParticle = function(particle) {
        const random = Math.floor(Math.random() * hearts.length),
          image = new Image()
          opacityObject = {opacity: 0}
        TweenLite.to(opacityObject, 2, {
          opacity: 1,
          ease: window.Power1.easeOut
        })
        image.addEventListener('load', () => {
          particle.customDraw = (canvasContext, x, y, width, height) => {
            canvasContext.globalAlpha = opacityObject.opacity
            canvasContext.drawImage(image, x, y, width, height)
          }
        })
        image.src = hearts[random]
      }

</script>

<script type="text/javascript">
var count_particles, stats, update;
stats = new Stats;
stats.setMode(0);
stats.domElement.style.position = 'absolute';
stats.domElement.style.left = '0px';
stats.domElement.style.top = '0px';
document.body.appendChild(stats.domElement);
count_particles = document.querySelector('.js-count-particles');
update = function() {
  stats.begin();
  stats.end();
  if (window.pJSDom[0].pJS.particles && window.pJSDom[0].pJS.particles.array) {
    count_particles.innerText = window.pJSDom[0].pJS.particles.array.length;
  }
  requestAnimationFrame(update);
};
requestAnimationFrame(update);
</script>

<script type="text/javascript">
setTimeout( function() {
    var canvas = document.getElementById("particles-js"),
    canvasWidth = canvas.offsetWidth,
    canvasHeight = canvas.offsetHeight,
    initialParticlesCount = window.pJSDom[0].pJS.particles.array.length,
    removeParticle = function() {
    if (window.pJSDom[0].pJS.particles && window.pJSDom[0].pJS.particles.array) {
        if(window.pJSDom[0].pJS.particles.array.length >= 1){
          for (element = 0; element < window.pJSDom[0].pJS.particles.array.length; ++element) {
            var particleX = window.pJSDom[0].pJS.particles.array[element].x / 2,
                particleY = window.pJSDom[0].pJS.particles.array[element].y / 2,
                particleWidth = 25,
                horizontalOut = (particleX - (particleWidth / 2)) >= canvasWidth  || (particleX + (particleWidth / 2)) <= 0,
                verticalOut = (particleY - (particleWidth / 2)) >= canvasHeight || (particleY + (particleWidth / 2)) <= 0;            
            if( horizontalOut || verticalOut) {                
                window.pJSDom[0].pJS.particles.array.splice(element,1);
                window.pJSDom[0].pJS.particlesDraw;
                window.pJSDom[0].pJS.particles.array.length
                console.log(element + " Particle removed");
                var currentParticleCount = window.pJSDom[0].pJS.particles.array.length;
                bgOpacity =  currentParticleCount / initialParticlesCount;
                canvas.style.backgroundColor = 'rgba(' + 47 + ',' + 31 + ',' + 69 + ',' + bgOpacity + ')';
            }
          };
        } else {
          document.body.className = "hide";
          console.log("no more particles")
        };
    }
    requestAnimationFrame(removeParticle);
};
requestAnimationFrame(removeParticle);
}, 3000 );

</script>
</html>